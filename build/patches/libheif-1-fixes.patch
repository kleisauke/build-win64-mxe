This file is part of MXE. See LICENSE.md for licensing information.

Contains ad hoc patches for cross building.

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Kleis Auke Wolthuizen <github@kleisauke.nl>
Date: Thu, 14 Mar 2019 14:30:00 +0200
Subject: [PATCH 1/2] Fix build errors + add install targets

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 1111111..2222222 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -1,6 +1,6 @@
 cmake_minimum_required (VERSION 3.3.2)
 
-project (heif
+project (libheif
     LANGUAGES C CXX
     VERSION 1.6.1.0
 )
@@ -59,3 +59,21 @@ include_directories ("${PROJECT_SOURCE_DIR}")
 add_subdirectory (examples)
 add_subdirectory (libheif)
 add_subdirectory (gdk-pixbuf)
+
+set(prefix ${CMAKE_INSTALL_PREFIX})
+set(exec_prefix "\${prefix}/bin")
+set(libdir "\${prefix}/lib")
+set(includedir "\${prefix}/include")
+set(VERSION ${PACKAGE_VERSION})
+set(have_libde265 ${LIBDE265_FOUND})
+set(have_x265 ${X265_FOUND})
+set(LIBS "")
+if(LIBDE265_FOUND)
+  set(LIBS "${LIBS} -lde265")
+endif()
+if(X265_FOUND)
+  set(LIBS "${LIBS} -lx256")
+endif()
+
+configure_file(libheif.pc.in libheif.pc @ONLY)
+install(FILES ${CMAKE_BINARY_DIR}/libheif.pc DESTINATION ${CMAKE_INSTALL_LIBDIR}/pkgconfig)
diff --git a/libheif/CMakeLists.txt b/libheif/CMakeLists.txt
index 1111111..2222222 100644
--- a/libheif/CMakeLists.txt
+++ b/libheif/CMakeLists.txt
@@ -1,6 +1,6 @@
 include(CMakePackageConfigHelpers)
 
-if(UNIX)
+if(UNIX OR MINGW)
   include (${CMAKE_ROOT}/Modules/FindPkgConfig.cmake)
   pkg_check_modules (LIBDE265 libde265)
   pkg_check_modules (X265 x265)
@@ -39,6 +39,11 @@ add_library(${PROJECT_NAME}
     ${libheif_headers}
 )
 
+set_target_properties(${PROJECT_NAME} PROPERTIES
+    PREFIX ""
+    IMPORT_PREFIX ""
+)
+
 # Needed to find libheif/heif_version.h while compiling the library
 target_include_directories(${PROJECT_NAME} PRIVATE ${PROJECT_BINARY_DIR})
 
From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Kleis Auke Wolthuizen <github@kleisauke.nl>
Date: Thu, 28 Nov 2019 16:57:28 +0100
Subject: [PATCH 2/2] Silence unused variable error


diff --git a/CMakeLists.txt b/CMakeLists.txt
index 1111111..2222222 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -34,6 +34,7 @@ if(NOT MSVC)
   add_definitions(-Wno-sign-conversion)
   add_definitions(-Wno-error=conversion)
   add_definitions(-Wno-error=unused-parameter)
+  add_definitions(-Wno-error=unused-variable)
   add_definitions(-Wno-error=deprecated-declarations)
 endif()
 
